// <auto-generated/>
namespace EUC.Profile.Buddy.GUI
{
    using EUC.Profile.Buddy.GUI.Classes;
    using EUC.Profile.Buddy.Common;
    using EUC.Profile.Buddy.Common.User;
    using EUC.Profile.Buddy.Common.Logging;
    using EUC.Profile.Buddy.Common.File;
    using EUC.Profile.Buddy.Common.File.Model;

    /// <summary>
    /// Class to handle FormMain.
    /// </summary>
    public partial class FormMain : Form
    {
        /// <summary>
        /// Initializes a new instance of the <see cref="FormMain"/> class.
        /// </summary>
        public FormMain()
        {
            this.InitializeComponent();
        }

        private void FormMain_Load(object sender, EventArgs e)
        {

            ILogger logger = new Logger();
            logger.LogAsync("Starting Application");

            logger.LogAsync("Building User Object");
            IUser user = new User();

            IFilesAndFolders filesAndFolders = new FilesAndFolders();

            GUIElements.MinimizeApplication(this, this.NotifyMain);
            GUIElements.UpdateLabel(lblUserName, user.UserName);
            GUIElements.UpdateLabel(lblProfileDirectory, user.ProfileDirectory);
            GUIElements.UpdateLabel(lblProfileSize, user.ProfileSize);

            List<(string folderName, string size, long rawSize)> profileFolders = filesAndFolders.BuildTreeSize(user.ProfileDirectory);

            foreach(var folder in profileFolders)
            {
                this.dgUserProfileFolders.Rows.Add(folder.folderName, folder.size);
            }
        }

        private void NotifyMain_MouseDoubleClick(object sender, MouseEventArgs e)
        {
            GUIElements.RestoreApplication(this, this.NotifyMain);
        }

        private void btnMinimize_Click(object sender, EventArgs e)
        {
            GUIElements.MinimizeApplication(this, this.NotifyMain);
        }

        private void btnExit_Click(object sender, EventArgs e)
        {
            DialogResult dialogResult = GUIElements.DisplayYesNoMessage("Are you sure you want to quit?");
            if (dialogResult == DialogResult.Yes)
            {
                Application.Exit();
            }
        }

        private void exitToolStripMenuItem_Click(object sender, EventArgs e)
        {
            DialogResult dialogResult = GUIElements.DisplayYesNoMessage("Are you sure you want to quit?");
            if (dialogResult == DialogResult.Yes)
            {
                Application.Exit();
            }
        }

        private void showDetailToolStripMenuItem_Click(object sender, EventArgs e)
        {
            GUIElements.RestoreApplication(this, this.NotifyMain);
        }
    }
}
